<main class="main">
  <a
    class="github-project"
    href="https://github.com/laefy13/ytspot"
    target="_blank"
  >
    <img src="/assets/github-mark-white.png" />
  </a>
  <div class="flex h-screen sm:flex-row flex-col mb-30 sm:mb-0">
    <div class="flex flex-col md:w-1/2 p-10 w-full">
      <div class="spotify w-full flex flex-col">
        <div class="flex flex-col">
          <label
            for="success"
            class="flex mb-2 text-sm font-medium text-green dark:text-green"
            >Spotify playlist link</label
          >
          <div
            class="input flex items-center md:justify-between flex-col md:flex-row"
          >
            <div class="relative items-center w-full md:w-8/12">
              <input
                type="text"
                id="success"
                [ngClass]="spotify_loading ? 'shadow-md opacity-20' : ''"
                class="bg-green w-full border border-green text-green dark:text-green placeholder-green dark:placeholder-red text-sm rounded-lg focus:ring-red focus:border-green block p-2.5 dark:bg-transparent dark:border-green"
                placeholder="Spotify playlist Link"
                [formControl]="spotify_link"
                value="https://open.spotify.com/playlist/1gKIYxGVZBUpkmqamRa60w?si=655b6326c62f4a51"
                (click)="clearInput(spotify_link)"
                [readonly]="spotify_loading"
              />

              <app-loading [is_loading]="spotify_loading" />
            </div>
            <button
              type="button"
              class="w-3/12 focus:outline-none text-white bg-green hover:bg-green focus:ring-4 focus:ring-green font-medium rounded-lg text-sm px-5 py-2.5 me-2 dark:bg-green dark:hover:bg-green dark:focus:ring-green"
              (click)="getDataFromApi(false)"
            >
              Add Playlist
            </button>
          </div>
        </div>
        <div
          class="mb-5 text-white"
          [style.min-height.px]="spotify_message ? 'auto' : '30'"
        >
          {{ spotify_message }}
        </div>
      </div>

      <div class="youtube w-full flex flex-col">
        <div class="flex flex-col">
          <label
            for="error"
            class="flex block mb-2 text-sm font-medium text-red dark:text-red"
            >Youtube playlist link</label
          >
          <div
            class="input flex items-center md:justify-between flex-col md:flex-row"
          >
            <div class="relative items-center w-full md:w-8/12">
              <input
                type="text"
                id="error"
                [ngClass]="youtube_loading ? 'shadow-md opacity-20' : ''"
                class="w-full bg-red border border-red text-red placeholder-red text-sm rounded-lg focus:ring-red dark:bg-transparent focus:border-red block p-2.5 dark:text-red dark:placeholder-red dark:border-red"
                placeholder="Youtube playlist Link"
                [formControl]="youtube_link"
                [value]="
                  'https://youtube.com/playlist?list=PL4xFhy5pDwEiI2FWxPOBpdwiY-Ju5uIZW&si=Amms7BzTLGVt5Reo'
                "
                [readonly]="youtube_loading"
                (click)="clearInput(youtube_link)"
              />
              <app-loading [is_loading]="youtube_loading" />
            </div>
            <button
              type="button"
              class="w-3/12 focus:outline-none text-white bg-red hover:bg-red focus:ring-4 focus:ring-red font-medium rounded-lg text-sm px-5 py-2.5 me-2 dark:bg-red dark:hover:bg-red dark:focus:ring-red"
              (click)="getDataFromApi(true)"
            >
              Add playlist
            </button>
          </div>
        </div>
        <div
          class="mb-5 text-white"
          [style.min-height.px]="youtube_message ? 'auto' : '30'"
        >
          {{ youtube_message }}
        </div>
      </div>

      <div class="players flex justify-center flex-col" id="players">
        <app-spotify-web-playback
          [player_state]="player_state"
          [img_url]="img_url"
          [update_class]="update_class"
        />
        <app-youtube-web-playback />
      </div>
    </div>
    <div
      class="main-queue flex flex-col h-full items-center sm:w-1/2 p-2 w-full"
    >
      <div class="misc-buttons mt-10">
        <button
          class="misc-button bg-lightgreen hover:green focus:outline-none focus:ring-4 focus:ring-gray-300 font-medium rounded-lg text-sm px-5 py-2.5 me-2 mb-2 dark:bg-lightgreen dark:hover:bg-green dark:focus:ring-darkbg-green dark:border-darkbg-green"
          (click)="saveUrls()"
        >
          Save Urls
        </button>
        <button
          class="misc-button bg-lightgreen hover:green focus:outline-none focus:ring-4 focus:ring-gray-300 font-medium rounded-lg text-sm px-5 py-2.5 me-2 mb-2 dark:bg-lightgreen dark:hover:bg-green dark:focus:ring-darkbg-green dark:border-darkbg-green"
          (click)="getUrls()"
        >
          Get Urls
        </button>
        <button
          class="misc-button bg-lightgreen hover:green focus:outline-none focus:ring-4 focus:ring-gray-300 font-medium rounded-lg text-sm px-5 py-2.5 me-2 mb-2 dark:bg-lightgreen dark:hover:bg-green dark:focus:ring-darkbg-green dark:border-darkbg-green"
          (click)="makeQueue()"
        >
          Make Q
        </button>
      </div>
      <div
        class="queue-container flex flex-col h-4/5 items-center p-5 w-full relative"
      >
        <div
          cdkDropList
          (cdkDropListDropped)="drop($event)"
          [ngClass]="
            spotify_loading || youtube_loading ? 'shadow-md opacity-20' : ''
          "
          class="example-list min-w-1/2 w-fit overflow-y-auto w-1/2 border border-lightgreen h-full bg-transparent relative items-center"
          [cdkDropListAutoScrollDisabled]="false"
          cdkScrollable
        >
          @if(queue.length < 1){
          <div class="p-5">Empty Queue</div>
          } @else { @for (song of queue; track song) {

          <div
            class="example-box"
            [ngClass]="boxColor(song[0])"
            [id]="song[2]"
            cdkDrag
          >
            <div class="song-name">
              {{ song[1] }}
            </div>
            <div class="song-buttons">
              <button (click)="immediatePlay(song[4])">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  viewBox="0 0 24 24"
                  width="24"
                  height="24"
                  fill="black"
                >
                  <path d="M8 5v14l11-7z" />
                </svg>
              </button>
              <button (click)="removeFromQueue(song[4])">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  x="0px"
                  y="0px"
                  width="20"
                  height="20"
                  viewBox="0 0 100 100"
                >
                  <path
                    d="M 46 13 C 44.35503 13 43 14.35503 43 16 L 43 18 L 32.265625 18 C 30.510922 18 28.879517 18.922811 27.976562 20.427734 L 26.433594 23 L 23 23 C 20.802666 23 19 24.802666 19 27 C 19 29.197334 20.802666 31 23 31 L 24.074219 31 L 27.648438 77.458984 C 27.88773 80.575775 30.504529 83 33.630859 83 L 66.369141 83 C 69.495471 83 72.11227 80.575775 72.351562 77.458984 L 75.925781 31 L 77 31 C 79.197334 31 81 29.197334 81 27 C 81 24.802666 79.197334 23 77 23 L 73.566406 23 L 72.023438 20.427734 C 71.120481 18.922811 69.489078 18 67.734375 18 L 57 18 L 57 16 C 57 14.35503 55.64497 13 54 13 L 46 13 z M 46 15 L 54 15 C 54.56503 15 55 15.43497 55 16 L 55 18 L 45 18 L 45 16 C 45 15.43497 45.43497 15 46 15 z M 32.265625 20 L 43.832031 20 A 1.0001 1.0001 0 0 0 44.158203 20 L 55.832031 20 A 1.0001 1.0001 0 0 0 56.158203 20 L 67.734375 20 C 68.789672 20 69.763595 20.551955 70.306641 21.457031 L 71.833984 24 L 68.5 24 A 0.50005 0.50005 0 1 0 68.5 25 L 73.5 25 L 77 25 C 78.116666 25 79 25.883334 79 27 C 79 28.116666 78.116666 29 77 29 L 23 29 C 21.883334 29 21 28.116666 21 27 C 21 25.883334 21.883334 25 23 25 L 27 25 L 61.5 25 A 0.50005 0.50005 0 1 0 61.5 24 L 28.166016 24 L 29.693359 21.457031 C 30.236405 20.551955 31.210328 20 32.265625 20 z M 64.5 24 A 0.50005 0.50005 0 1 0 64.5 25 L 66.5 25 A 0.50005 0.50005 0 1 0 66.5 24 L 64.5 24 z M 26.078125 31 L 73.921875 31 L 70.357422 77.306641 C 70.196715 79.39985 68.46881 81 66.369141 81 L 33.630859 81 C 31.53119 81 29.803285 79.39985 29.642578 77.306641 L 26.078125 31 z M 38 35 C 36.348906 35 35 36.348906 35 38 L 35 73 C 35 74.651094 36.348906 76 38 76 C 39.651094 76 41 74.651094 41 73 L 41 38 C 41 36.348906 39.651094 35 38 35 z M 50 35 C 48.348906 35 47 36.348906 47 38 L 47 73 C 47 74.651094 48.348906 76 50 76 C 51.651094 76 53 74.651094 53 73 L 53 69.5 A 0.50005 0.50005 0 1 0 52 69.5 L 52 73 C 52 74.110906 51.110906 75 50 75 C 48.889094 75 48 74.110906 48 73 L 48 38 C 48 36.889094 48.889094 36 50 36 C 51.110906 36 52 36.889094 52 38 L 52 63.5 A 0.50005 0.50005 0 1 0 53 63.5 L 53 38 C 53 36.348906 51.651094 35 50 35 z M 62 35 C 60.348906 35 59 36.348906 59 38 L 59 39.5 A 0.50005 0.50005 0 1 0 60 39.5 L 60 38 C 60 36.889094 60.889094 36 62 36 C 63.110906 36 64 36.889094 64 38 L 64 73 C 64 74.110906 63.110906 75 62 75 C 60.889094 75 60 74.110906 60 73 L 60 47.5 A 0.50005 0.50005 0 1 0 59 47.5 L 59 73 C 59 74.651094 60.348906 76 62 76 C 63.651094 76 65 74.651094 65 73 L 65 38 C 65 36.348906 63.651094 35 62 35 z M 38 36 C 39.110906 36 40 36.889094 40 38 L 40 73 C 40 74.110906 39.110906 75 38 75 C 36.889094 75 36 74.110906 36 73 L 36 38 C 36 36.889094 36.889094 36 38 36 z M 59.492188 41.992188 A 0.50005 0.50005 0 0 0 59 42.5 L 59 44.5 A 0.50005 0.50005 0 1 0 60 44.5 L 60 42.5 A 0.50005 0.50005 0 0 0 59.492188 41.992188 z"
                  ></path>
                </svg>
              </button>
            </div>
          </div>
          }}
        </div>
        <app-loading
          [is_loading]="spotify_loading || youtube_loading"
          [additional_text]="'Getting data & making new queue'"
        />
      </div>
    </div>
  </div>
  <div
    class="flex justify-center rounded-t-full"
    (mouseenter)="resetTimer()"
    (mouseleave)="mouseLeft()"
  >
    <div
      class="controller fixed justify-center items-center rounded-t-full bottom-0 bg-white border-t border-gray-200 dark:bg-gray-700 dark:border-gray-600"
      [ngClass]="
        showControllers
          ? ' animate-showController w-1/2 h-10per'
          : ' animate-hideController w-1/6 h-8per'
      "
    >
      <div
        class="bg-slate-50 rounded-t-full text-slate-500 dark:bg-slate-600 dark:text-slate-200 flex items-center h-full justify-evenly"
      >
        <div
          class="song overflow-y-hidden hidden"
          [ngClass]="
            showControllers
              ? ' w-20 sm:block lg:hidden xl:block'
              : ' w-40 sm:inline lg:hidden xl:inline'
          "
        >
          <div class="text-center">Playing:</div>

          <div
            class="song animate-marquee whitespace-nowrap w-100vw text-center"
          >
            {{ playing_song }}
          </div>
        </div>
        <div
          class="controllers-container w-3/5"
          [ngClass]="{ hidden: !showControllers }"
        >
          <div class="flex-auto flex items-center justify-evenly">
            <button
              type="button"
              class="sm:block lg:block xl:block"
              aria-label="Previous"
              (click)="prevSong()"
            >
              <svg width="24" height="24" fill="none">
                <path
                  d="m10 12 8-6v12l-8-6Z"
                  fill="currentColor"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                />
                <path
                  d="M6 6v12"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                />
              </svg>
            </button>
            <button
              type="button"
              class="bg-white text-slate-900 dark:bg-slate-100 dark:text-slate-700 flex-none -my-2 mx-auto w-10 h-10 sm:w-20 sm:h-20 rounded-full ring-1 ring-slate-900/5 shadow-md flex items-center justify-center"
              aria-label="Pause"
              (click)="mainController()"
            >
              <svg width="30" height="32" fill="black" *ngIf="playing[0]">
                <rect x="10" y="5" width="2" height="21" rx="2" />
                <rect x="18" y="5" width="2" height="21" rx="2" />
              </svg>
              <svg
                *ngIf="!playing[0]"
                xmlns="http://www.w3.org/2000/svg"
                viewBox="0 0 24 24"
                width="24"
                height="24"
                fill="black"
              >
                <path d="M8 5v14l11-7z" />
              </svg>
            </button>
            <button
              type="button"
              class="sm:block lg:block xl:block"
              aria-label="Next"
              (click)="nextSong()"
            >
              <svg width="24" height="24" fill="none">
                <path
                  d="M14 12 6 6v12l8-6Z"
                  fill="currentColor"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                />
                <path
                  d="M18 6v12"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                />
              </svg>
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
</main>

<router-outlet />
